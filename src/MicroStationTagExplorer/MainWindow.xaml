<Window x:Class="MicroStationTagExplorer.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:local="clr-namespace:MicroStationTagExplorer"
        mc:Ignorable="d"
        Title="MicroStation Tag Explorer" Height="650" Width="1000"
        WindowStartupLocation="CenterScreen" WindowState="Normal"
        UseLayoutRounding="True" TextOptions.TextFormattingMode="Display" SnapsToDevicePixels="True"
        PreviewKeyDown="Window_PreviewKeyDown"
        AllowDrop="True" Drop="Window_Drop" DragEnter="Window_DragEnter">
    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
            <RowDefinition Height="8"/>
            <RowDefinition Height="*"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>
        <Menu x:Name="MainMenu" Background="Transparent" Grid.Row="0">
            <MenuItem x:Name="FileMenu" Header="_File">
                <MenuItem x:Name="FileAddFiles" Header="Add _Files..." InputGestureText="Ctrl+L" Click="FileAddFiles_Click"/>
                <Separator/>
                <MenuItem x:Name="FileNewProject" Header="_New Project..." InputGestureText="Ctrl+N" Click="FileNewProject_Click"/>
                <Separator/>
                <MenuItem x:Name="FileOpenProject" Header="_Open Project..." InputGestureText="Ctrl+O" Click="FileOpenProject_Click"/>
                <Separator/>
                <MenuItem x:Name="FileSaveProject" Header="_Save Project..." InputGestureText="Ctrl+S" Click="FileSaveProject_Click"/>
                <Separator/>
                <MenuItem x:Name="FileExit" Header="E_xit" InputGestureText="Alt+F4" Click="FileExit_Click"/>
            </MenuItem>
            <MenuItem x:Name="TagsMenu" Header="_Tags">
                <MenuItem x:Name="TagsGet" Header="_Get" InputGestureText="F5" Click="TagsGet_Click"/>
                <Separator/>
                <MenuItem x:Name="TagsImport" Header="_Import..." InputGestureText="Ctrl+I" Click="TagsImport_Click"/>
                <Separator/>
                <MenuItem x:Name="TagsExport" Header="_Export..." InputGestureText="Ctrl+E" Click="TagsExport_Click"/>
            </MenuItem>
        </Menu>
        <DataGrid x:Name="DataGridFiles" 
                  ItemsSource="{Binding Files}" 
                  AutoGenerateColumns="False" CanUserAddRows="False"
                  Margin="3" Grid.Row="1">
            <DataGrid.Columns>
                <DataGridTextColumn Header="Path" Binding="{Binding Path}"/>
            </DataGrid.Columns>
        </DataGrid>
        <GridSplitter ResizeDirection="Rows" Grid.Row="2" Background="Transparent" VerticalAlignment="Stretch" HorizontalAlignment="Stretch"/>
        <Grid Grid.Row="3">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="*"/>
                <ColumnDefinition Width="8"/>
                <ColumnDefinition Width="*"/>
            </Grid.ColumnDefinitions>
            <DataGrid x:Name="DataGridTags" 
                      DataContext="{Binding ElementName=DataGridFiles, Path=SelectedItem.Tags}" 
                      ItemsSource="{Binding}" 
                      AutoGenerateColumns="False" CanUserAddRows="False"
                      Margin="3" Grid.Column="0">
                <DataGrid.Columns>
                    <DataGridTextColumn Header="TagSetName" Binding="{Binding TagSetName}"/>
                    <DataGridTextColumn Header="TagDefinitionName" Binding="{Binding TagDefinitionName}"/>
                    <DataGridTextColumn Header="Value" Binding="{Binding Value}"/>
                    <DataGridTextColumn Header="ID" Binding="{Binding ID}"/>
                    <DataGridTextColumn Header="HostID" Binding="{Binding HostID}"/>
                    <DataGridTextColumn Header="Path" Binding="{Binding Path}"/>
                </DataGrid.Columns>
            </DataGrid>
            <GridSplitter ResizeDirection="Columns" Grid.Column="1" Background="Transparent" VerticalAlignment="Stretch" HorizontalAlignment="Stretch"/>
            <Grid Grid.Column="2">
                <Grid.RowDefinitions>
                    <RowDefinition Height="*"/>
                    <RowDefinition Height="8"/>
                    <RowDefinition Height="*"/>
                </Grid.RowDefinitions>
                <DataGrid x:Name="DataGridTagSets" 
                          DataContext="{Binding ElementName=DataGridFiles, Path=SelectedItem.TagSets}" 
                          ItemsSource="{Binding}" 
                          AutoGenerateColumns="False" CanUserAddRows="False"
                          Margin="3" Grid.Row="0">
                    <DataGrid.Columns>
                        <DataGridTextColumn Header="Name" Binding="{Binding Name}"/>
                    </DataGrid.Columns>
                </DataGrid>
                <GridSplitter ResizeDirection="Rows" Grid.Row="1" Background="Transparent" VerticalAlignment="Stretch" HorizontalAlignment="Stretch"/>
                <DataGrid x:Name="DataGridTagDefinitions" 
                          DataContext="{Binding ElementName=DataGridTagSets, Path=SelectedItem.TagDefinitions}" 
                          ItemsSource="{Binding}" 
                          AutoGenerateColumns="False" CanUserAddRows="False"
                          Margin="3" Grid.Row="2">
                    <DataGrid.Columns>
                        <DataGridTextColumn Header="Name" Binding="{Binding Name}"/>
                    </DataGrid.Columns>
                </DataGrid>
            </Grid>
        </Grid>
        <Grid Grid.Row="4">
            <TextBox x:Name="TextBoxStatus" Text="" TextWrapping="NoWrap" IsReadOnly="True" Margin="3"/>
        </Grid>
    </Grid>
</Window>
